- hosts: db1
  user: vagrant
  tasks:
  - name: bootstrap the first node
    service: name=mysql state=restarted args="--wsrep_new_cluster"
- hosts: db2:db3
  user: vagrant
  tasks:
  - name: make the other nodes join the cluster
    service: name=mysql state=restarted
- hosts: db1
  user: vagrant
  tasks:
  - name: Install python module
    yum: name=MySQL-python state=present
    when: ansible_os_family == 'RedHat'
  - name: Install python module
    apt: name=python-mysqldb state=present
    when: ansible_os_family == 'Debian'
  - name: Create superuser
    mysql_user: name=maxuser host=% password=maxpwd priv=*.*:ALL state=present
  - name: Create maxscale user
    mysql_user: name=maxadmin host="%" password=maxpwd priv=*.*:SELECT,"SHOW DATABASES" state=present
